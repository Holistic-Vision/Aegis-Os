<!doctype html>
<html lang="fr" data-theme="dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#ff7a1a" />
  <link rel="manifest" href="./manifest.webmanifest" />
  <link rel="stylesheet" href="./app.css?v=0.8.7&b=20260115T160113Z" />
  <title>AEGIS</title>
</head>
<body>
  <div id="root">
    <div class="grid">
      <div class="card">
        <h2>AEGIS</h2>
        <div class="small">Chargement…</div>
      </div>

      <div class="card" id="boot-error-box" style="display:none">
        <h2 id="boot-error-title">Erreur JavaScript</h2>
        <div class="pill" style="display:inline-block;margin:8px 0">Boot error</div>
        <div class="small" id="boot-error-msg" style="margin-bottom:10px">—</div>
        <pre id="boot-error-detail" class="small" style="white-space:pre-wrap;word-break:break-word;opacity:.9"></pre>
        <div class="row" style="margin-top:12px">
          <button class="btn primary" id="boot-reload">Recharger</button>
          <button class="btn ghost" id="boot-debug">Debug</button>
          <button class="btn ghost" id="boot-copy">Copier</button>
        </div>
        <div class="small" style="margin-top:10px;opacity:.8">Astuce : ouvre aussi <code>./version.json</code> pour vérifier la version servie.</div>
      </div>
    </div>
  </div>

  <script>
  (function(){
    function showBootError(title, msg, detail){
      var box = document.getElementById("boot-error-box");
      var t = document.getElementById("boot-error-title");
      var m = document.getElementById("boot-error-msg");
      var d = document.getElementById("boot-error-detail");
      if(t) t.textContent = title || "Erreur JavaScript";
      if(m) m.textContent = msg || "Erreur inconnue";
      if(d) d.textContent = detail || "";
      if(box) box.style.display = "block";
    }
    window.__AEGIS_showBootError = showBootError;

    window.addEventListener("error", function(e){
      try{
        var src = (e && e.filename) ? e.filename : "";
        var loc = (e && (e.lineno || e.colno)) ? ("\n" + src + ":" + (e.lineno||0) + ":" + (e.colno||0)) : "";
        showBootError("Erreur JavaScript", (e && e.message) ? e.message : "Erreur inconnue", loc);
      }catch(_){}
    });
    window.addEventListener("unhandledrejection", function(e){
      try{
        var r = e && e.reason;
        showBootError("Erreur Promise", (r && r.message) ? r.message : String(r), "");
      }catch(_){}
    });
    document.addEventListener("DOMContentLoaded", function(){
      var r = document.getElementById("boot-reload");
      if(r) r.addEventListener("click", function(){ location.reload(); });
      var b = document.getElementById("boot-debug");
      if(b) b.addEventListener("click", function(){
        var det = document.getElementById("boot-error-detail");
        if(det) det.style.display = (det.style.display === "none") ? "block" : "block";
      });
      var c = document.getElementById("boot-copy");
      if(c) c.addEventListener("click", function(){
        var t = (document.getElementById("boot-error-detail")||{}).textContent || "";
        if(!t) t = (document.getElementById("boot-error-msg")||{}).textContent || "";
        try{ navigator.clipboard.writeText(t); }catch(e){}
      });
    });
  })();
  </script>

  <script type="module" src="./router.js?v=0.8.7&b=20260115T160113Z"></script>
  <script type="module" src="./db.js?v=0.8.7&b=20260115T160113Z"></script>
  <script type="module" src="./ai.js?v=0.8.7&b=20260115T160113Z"></script>
  <script type="module" src="./app.js?v=0.8.7&b=20260115T160113Z"></script>
</body>
</html>
